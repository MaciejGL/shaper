'use client'

interface BackBodyViewProps {
  selectedMuscleGroups: string[]
  onMuscleGroupClick: (muscleGroupId: string) => void
  muscleGroups: { id: string; alias?: string | null; groupSlug: string }[]
  className?: string
}

export function BackBodyView({
  selectedMuscleGroups = [],
  onMuscleGroupClick,
  muscleGroups = [],
  className = '',
}: BackBodyViewProps) {
  const getMuscleGroupsByAlias = (aliases: string[]) => {
    if (!muscleGroups || !Array.isArray(muscleGroups)) return []
    return muscleGroups.filter((mg) => mg.alias && aliases.includes(mg.alias))
  }

  const isRegionSelected = (aliases: string[]) => {
    const regionMuscles = getMuscleGroupsByAlias(aliases)
    return regionMuscles.some(
      (muscle) => muscle.alias && selectedMuscleGroups.includes(muscle.alias),
    )
  }

  const handleRegionClick = (aliases: string[]) => {
    const regionMuscles = getMuscleGroupsByAlias(aliases)
    regionMuscles.forEach(
      (muscle) => muscle.alias && onMuscleGroupClick(muscle.alias),
    )
  }

  const getPathProps = (aliases: string[]) => ({
    className: `cursor-pointer transition-all duration-200 ${
      isRegionSelected(aliases)
        ? 'fill-primary stroke-primary-foreground stroke-2'
        : 'fill-muted hover:fill-muted-foreground stroke-border stroke-1'
    }`,
    onClick: () => handleRegionClick(aliases),
    style: { fillOpacity: isRegionSelected(aliases) ? 0.8 : 0.6 },
  })

  return (
    <div className={`flex justify-center ${className}`}>
      <svg
        width="200"
        height="400"
        viewBox="0 0 200 400"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g clipPath="url(#clip0_1191_3043)">
          {/* Head - non-clickable */}
          <path
            d="M83.0001 40.5145C83.0095 31.7165 85.7281 28.3054 94.2565 26.391C97.8043 25.5937 104.159 26.0575 108.142 27.4029C113.66 29.2674 116.012 33.2224 116 40.6229C115.993 46.1526 115.218 48.4517 113.012 49.498C110.713 50.5871 109.826 51.6105 107.53 55.8219C106.248 58.1751 106.928 57.9927 99.4565 57.9927C91.7867 57.9927 92.6379 58.3096 90.7643 54.7578C89.2612 51.9075 87.8841 50.4307 85.8939 49.5345C83.6298 48.5152 82.9927 46.5299 83.0001 40.5145Z"
            fill="#424747"
          />

          {/* Traps */}
          <path
            d="M77.6481 83.3651C77.9891 83.1851 81.3081 82.4001 82.4951 82.2181C86.5281 81.5991 94.1661 82.9921 95.4121 84.5731C95.4691 84.6461 95.8081 84.9092 96.1651 85.1582C98.9581 87.1082 99.4151 100.979 97.4991 125.686C97.0521 131.455 97.0041 131.549 96.0211 128.592C95.0721 125.738 94.4471 124.417 92.4311 121.005C87.9831 113.478 86.7021 110.375 83.4521 99.2692C81.0011 90.8952 79.1801 86.0591 77.7871 84.2261C77.3161 83.6051 77.3061 83.5441 77.6481 83.3651Z"
            {...getPathProps(['Traps'])}
            title="Left Traps"
          />
          <path
            d="M100.898 104.165C100.616 85.8162 101.65 83.4742 110.517 82.3882C114.454 81.9062 116.657 82.0282 120.293 82.9272C122.283 83.4192 122.261 83.4002 121.725 84.1252C120.148 86.2592 118.577 90.6102 114.568 103.956C112.555 110.656 110.673 114.926 107.164 120.754C105.27 123.898 103.99 126.628 103.318 128.954C102.575 131.525 102.42 131.173 102.014 125.988C101.221 115.87 101.016 111.864 100.898 104.165Z"
            {...getPathProps(['Traps'])}
            title="Right Traps"
          />

          {/* Rear Delts */}
          <path
            d="M127.912 88.5065C127.912 88.1485 131.062 86.3095 132.183 86.0135C138.213 84.4215 146.354 91.1055 146.517 97.7845C146.636 102.691 146.445 109.791 146.193 109.787C145.656 109.781 142.301 108.156 141.426 107.478C137.546 104.474 136.508 103.182 136.229 101.009C135.441 94.8945 134.368 93.0635 129.725 89.9145C128.728 89.2385 127.912 88.6045 127.912 88.5065Z"
            {...getPathProps(['Rear Delts'])}
            title="Right Rear Delt"
          />
          <path
            d="M53.3216 95.1763C54.4606 91.4903 58.2796 87.7013 62.3216 86.2463C64.7256 85.3823 67.5376 85.7903 70.0776 87.3733C71.9556 88.5433 72.0336 88.3093 69.0736 90.3953C65.0976 93.1973 63.3466 96.3023 63.3326 100.578C63.3266 102.53 62.1516 104.183 58.9546 106.737C57.5036 107.896 53.9516 109.79 53.2286 109.79C52.6846 109.79 52.7666 96.9723 53.3216 95.1763Z"
            {...getPathProps(['Rear Delts'])}
            title="Left Rear Delt"
          />

          {/* Lats */}
          <path
            d="M118.737 94.4773C119.21 92.0603 119.985 90.0453 120.66 89.4763C121.394 88.8593 121.277 88.8383 124.476 90.1663C126.727 91.1013 132.531 93.9693 133.06 94.4093C133.549 94.8143 133.346 95.4853 131.781 98.6443C129.37 103.508 128.141 104.657 122.031 107.765C114.976 111.353 114.332 111.028 116.115 104.773C117.309 100.588 118.312 96.6473 118.737 94.4773Z"
            {...getPathProps(['Lats'])}
            title="Right Lats"
          />
          <path
            d="M66.0371 94.8981C66.0371 94.4341 69.7471 92.4501 74.6831 90.2761C78.7461 88.4861 79.3701 88.8161 80.4061 93.3031C81.3131 97.2321 82.5431 102.024 83.4501 105.16C85.1641 111.088 84.4441 111.341 76.8701 107.472C72.4091 105.193 70.9421 104.058 69.3551 101.656C68.2361 99.9631 66.0371 95.4841 66.0371 94.8981Z"
            {...getPathProps(['Lats'])}
            title="Left Lats"
          />

          {/* Rhomboids */}
          <path
            d="M83.0875 113.272C83.5345 112.667 84.2445 111.87 84.6635 111.501C85.8335 110.474 85.6105 110.147 89.1015 118.019C91.1045 122.535 92.2695 124.793 93.3805 126.315C94.8505 128.329 94.6515 129.633 91.6575 137.602C90.8825 139.665 89.9045 142.102 89.4845 143.019C89.0645 143.936 88.2675 145.904 87.7115 147.394C87.1565 148.883 86.2155 151.321 85.6195 152.811C85.0245 154.3 84.0725 156.831 83.5035 158.436C82.9355 160.04 82.3825 161.441 82.2745 161.55C81.9885 161.84 80.6225 160.45 78.8035 158.019C76.0485 154.336 76.2875 155.078 74.4755 144.581C73.9715 141.659 73.3256 138.378 73.0396 137.29C72.3936 134.828 71.9755 132.402 71.5505 128.644C71.1245 124.873 71.0195 124.509 69.6655 122.114C68.3495 119.785 67.5165 117.361 67.3475 115.367L67.2275 113.966L68.6635 114.672C73.7575 117.177 80.7005 116.503 83.0875 113.272Z"
            {...getPathProps(['Rhomboids'])}
            title="Rhomboids"
          />
          <path
            d="M109.781 119.27C110.847 116.864 112.142 113.981 112.658 112.864C113.175 111.746 113.687 110.832 113.797 110.832C114.222 110.832 115.655 112.168 116.344 113.206C118.477 116.419 125.719 117.19 130.671 114.732C132.373 113.888 132.44 113.947 132.087 115.977C131.725 118.056 130.964 120.048 129.657 122.336C128.595 124.195 128.464 124.564 128.215 126.409C128.063 127.524 127.746 129.859 127.51 131.598C127.273 133.337 126.792 135.868 126.441 137.223C126.09 138.578 125.29 142.64 124.665 146.249C123.149 154.995 122.62 156.254 118.68 160.488C117.219 162.058 117.294 162.113 115.966 158.489C114.037 153.226 111.359 146.244 110.633 144.582C108.317 139.281 105.709 132.148 105.226 129.791C104.915 128.277 105.111 127.667 106.619 125.447C107.399 124.299 108.547 122.057 109.781 119.27Z"
            {...getPathProps(['Rhomboids'])}
            title="Rhomboids"
          />

          {/* Lower Back */}
          <path
            d="M62.2931 119.985C63.1491 119.233 64.0821 118.459 64.3661 118.265C65.1001 117.764 65.2761 117.901 65.5481 119.18C66.0611 121.592 65.7731 123.982 64.6221 126.873C64.2801 127.732 63.7421 129.42 63.4281 130.623C62.7411 133.25 62.5711 133.604 61.0051 135.664C59.5471 137.58 59.4741 137.757 59.0551 140.36C58.6631 142.8 58.0911 144.126 56.8291 145.519C56.3101 146.092 55.6451 146.842 55.3511 147.186C53.7581 149.046 53.6401 144.077 55.1041 136.823C55.5031 134.845 55.9241 132.149 56.0401 130.831C56.1551 129.514 56.2901 127.997 56.3401 127.462C56.5251 125.465 57.6211 124.088 62.2931 119.985Z"
            {...getPathProps(['Lower Back'])}
            title="Lower Back"
          />
          <path
            d="M134.576 126.248C133.804 124.446 133.469 120.529 133.939 118.8C134.071 118.313 134.246 117.915 134.327 117.915C134.86 117.918 137.013 119.713 140.291 122.887C142.809 125.325 143.116 126.017 143.337 129.756C143.445 131.594 143.772 133.93 144.26 136.352C145.645 143.228 145.768 148.306 144.533 147.574C142.76 146.524 140.767 143.008 140.356 140.206C140.027 137.967 139.738 137.303 138.297 135.484C137.05 133.909 136.656 133.039 135.864 130.102C135.523 128.842 134.944 127.107 134.576 126.248Z"
            {...getPathProps(['Lower Back'])}
            title="Lower Back"
          />

          {/* Triceps */}
          <path
            d="M87.6744 151.456C89.4284 146.942 91.6114 141.942 93.5634 137.967C94.4774 136.105 95.3164 134.581 95.4284 134.581C97.3614 134.581 98.4984 163.877 96.9624 174.109C96.5694 176.725 96.5834 176.717 94.6444 175.457C93.7484 174.876 91.8914 173.686 90.5164 172.814C84.3704 168.914 83.0164 167.963 82.8154 167.406C82.4454 166.378 83.6764 161.76 85.7334 156.456C86.1104 155.482 86.9844 153.232 87.6744 151.456Z"
            {...getPathProps(['Triceps'])}
            title="Left Triceps"
          />
          <path
            d="M102.727 175.363C101.121 167.221 101.577 142.402 103.457 135.661C103.638 135.012 103.866 134.587 104.008 134.634C105.334 135.076 115.417 159.626 116.463 164.961C117.012 167.757 117.234 167.51 110.075 172.081C108.729 172.941 106.658 174.277 105.473 175.05C102.89 176.737 102.995 176.725 102.727 175.363Z"
            {...getPathProps(['Triceps'])}
            title="Right Triceps"
          />

          {/* Glutes */}
          <path
            d="M36.7663 187.664C38.0883 182.696 40.3533 168.786 42.1273 154.738C42.6163 150.87 43.0623 147.708 43.1203 147.71C43.1773 147.712 43.6663 148.726 44.2053 149.964C46.4693 155.157 47.4193 165.517 46.0343 169.894C44.5023 174.732 40.3923 183.768 37.6713 188.279C36.1493 190.803 35.9643 190.677 36.7663 187.664Z"
            {...getPathProps(['Glutes'])}
            title="Left Glutes"
          />
          <path
            d="M159.277 162.394C158.383 154.439 158.288 151.948 158.845 151.046C159.263 150.37 159.368 150.642 159.883 153.748C163.633 176.366 164.443 180.428 166.46 186.738C167.385 189.633 167.397 189.945 166.546 189.032C163.086 185.32 160.991 177.643 159.277 162.394Z"
            {...getPathProps(['Glutes'])}
            title="Right Glutes"
          />

          {/* Hamstrings */}
          <path
            d="M48.0246 166.456C52.1556 154.164 52.2596 153.946 54.2926 153.221C56.8876 152.296 57.1646 152.8 55.8576 156.062C53.6126 161.663 53.0206 163.014 51.7356 165.469C51.0016 166.872 48.7096 171.433 46.6416 175.605C42.7406 183.478 41.4206 185.95 40.3276 187.435C39.1086 189.091 39.1696 188.519 40.4936 185.876C43.0776 180.715 44.2416 177.714 48.0246 166.456Z"
            {...getPathProps(['Hams'])}
            title="Left Hamstrings"
          />
          <path
            d="M147.646 165.311C145.593 161.407 142.553 153.818 142.792 153.195C142.958 152.764 144.667 152.927 145.796 153.48C147.286 154.211 147.349 154.361 151.769 167.498C155.212 177.734 157.678 183.883 159.955 187.915L160.485 188.852L159.815 188.232C158.764 187.258 157.557 185.084 153.108 176.144C150.827 171.561 148.369 166.686 147.646 165.311Z"
            {...getPathProps(['Hams'])}
            title="Right Hamstrings"
          />

          {/* Calves */}
          <path
            d="M71.0104 188.668C73.0954 184.431 81.1984 178.991 89.6834 176.133C91.2444 175.607 92.8894 175.485 93.5614 175.844C94.0864 176.125 96.9494 179.96 97.5814 181.228C98.9344 183.943 99.3214 189.109 98.6484 195.457C98.3394 198.367 98.1554 199.399 97.0754 204.269C96.7444 205.762 96.6174 207.001 96.6274 208.644C96.6634 214.752 93.4674 216.281 85.9504 213.754C84.5854 213.295 83.0094 212.859 82.4494 212.785C79.4044 212.381 74.1674 206.392 71.8144 200.623C70.0094 196.196 69.6844 191.363 71.0104 188.668Z"
            {...getPathProps(['Calves'])}
            title="Left Calves"
          />
          <path
            d="M102.269 180.519C103.285 178.943 105.237 176.352 105.689 175.98C108.437 173.718 124.762 182.456 128.072 187.961C131.257 193.258 127.993 203.599 121.01 210.332C119.274 212.006 118.26 212.599 116.761 212.818C116.191 212.901 114.856 213.282 113.794 213.663C109.24 215.301 106.407 215.291 104.231 213.631C103.145 212.803 103.044 212.442 102.887 208.852C102.767 206.088 102.614 204.982 101.996 202.375C99.8552 193.357 99.9712 184.083 102.269 180.519Z"
            {...getPathProps(['Calves'])}
            title="Right Calves"
          />
        </g>
        <defs>
          <clipPath id="clip0_1191_3043">
            <rect width="200" height="400" fill="white" />
          </clipPath>
        </defs>
      </svg>
    </div>
  )
}
